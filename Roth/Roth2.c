#include <stdint.h>
#include <string.h>
#include <emscripten.h>

#define STATE_WORDS 16
#define RATE_WORDS  8
#define RATE_BYTES  64
#define ROUNDS      30

#define ROTL64(x,n) (((x) << (n)) | ((x) >> (64 - (n))))

static const uint64_t RC[30] = {
    0x1B9D7B6A7F8E2D1C, 0x11C2F1E8B4A37095, 0xA47F9C3D2E1B5F68, 0x73E8D9C4B5A29107,
    0x5F2A8B6C7D3E4F19, 0x4B6D8E2F1A3C5D70, 0x39F1A2B3C4D5E6F7, 0x28C4D5E6F7A8B9C0,
    0x17F3E4D5C6B7A890, 0x06A1B2C3D4E5F678, 0x95F0E1D2C3B4A567, 0x84D3C2B1A0987654,
    0x73B2A19088776655, 0x62A1908877665544, 0x5190877665544332, 0x4087766554433221,
    0x3F87665544332211, 0x2E76554433221100, 0x1D654433221100FF, 0x0C5433221100FFEE,
    0xFB43221100FFEEDD, 0xEA321100FFEEDDCC, 0xD92100FFEEDDCCBB, 0xC810FFEEDDCCBBAA,
    0xB7FFEEDDCCBBAA99, 0xA6EEDDCCBBAA9988, 0x95DDCCBBAA998877, 0x84CCBBAA99887766,
    0x73BBAA9988776655, 0x62AA998877665544
};

// ... (Resten av RoTH implementasjonen din her - samme som f√∏r) ...

// WASM-compatible hash function
EMSCRIPTEN_KEEPALIVE
void roth_hash(const uint8_t *input, uint32_t input_len, uint8_t *output) {
    roth_v6_2_hash(input, input_len, output);
}
